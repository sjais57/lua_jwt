[[servers]]
# Your AD LDAP server
host = "ad.yourdomain.com"
port = 389
use_ssl = false
start_tls = true

# Service account used to bind to AD
bind_dn = "CN=ldap-reader,OU=ServiceAccounts,DC=yourdomain,DC=com"
bind_password = "your_password"

# Base where users are located
search_base_dns = ["OU=Users,DC=yourdomain,DC=com"]

# Match login user by sAMAccountName
search_filter = "(sAMAccountName=%s)"

[servers.attributes]
name = "givenName"
surname = "sn"
username = "sAMAccountName"
email =  "mail"

# Group search base
group_search_base_dns = ["OU=Groups,DC=yourdomain,DC=com"]
group_search_filter = "(&(objectClass=group)(member=%s))"
group_search_filter_user_attribute = "distinguishedName"

# Only users in 'unixtest' AD group can log in
[[servers.group_mappings]]
group_dn = "CN=unixtest,OU=Groups,DC=yourdomain,DC=com"
org_role = "Editor"
grafana_admin = false

# Optional fallback (or omit to deny all others)
[[servers.group_mappings]]
group_dn = "*"
org_role = "Viewer"



===
ldapsearch -x -H ldap://ad.yourdomain.com \
  -D "CN=ldap-reader,OU=ServiceAccounts,DC=yourdomain,DC=com" -W \
  -b "OU=Groups,DC=yourdomain,DC=com" \
  "(&(objectClass=group)(cn=unixtest))"


ldapsearch -x -H ldap://ad.corp.yourdomain.com \
  -D "CN=ldap-reader,OU=ServiceAccounts,DC=corp,DC=yourdomain,DC=com" -W \
  -b "OU=BAND,DC=corp,DC=yourdomain,DC=com" \
  "(sAMAccountName=john.doe)" dn
