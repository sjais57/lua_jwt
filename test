from fastapi import FastAPI, HTTPException
from pydantic import BaseModel
from typing import Optional

app = FastAPI(
    title="JWT Auth API",
    description="Generate and validate JWT tokens",
    version="1.0.0",
    docs_url="/jwt-docs",        # Swagger UI will be served here
    redoc_url="/redoc",          # Optional: ReDoc at /redoc
    openapi_url="/openapi.json"  # Needed for docs to load schema
)

class LoginRequest(BaseModel):
    username: str
    password: str
    api_key: Optional[str] = None
    secret: Optional[str] = None

@app.post("/token", tags=["JWT"])
def generate_token(request: LoginRequest):
    if request.username != "admin" or request.password != "admin":
        raise HTTPException(status_code=401, detail="Invalid credentials")

    return {
        "access_token": "fake_access_token",
        "refresh_token": "fake_refresh_token"
    }

@app.get("/", include_in_schema=False)
def root():
    return {"message": "Visit /jwt-docs for Swagger UI or /redoc for ReDoc"}
